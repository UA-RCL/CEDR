//
// Short and long preamble- specs 802.11a OFDM Sytems
//  
// Description:  
//	     Time domain represenatation 
//	     1. Short preamble (161 complex numbers-8us(symbol duraiton)) 
//           2. Long Preamble (161 complex numbers - 8us)
//  
//Modified by Chagari  Reddy on 9/22/15.
//
// 

#include <stdio.h>
#include "baseband_lib.h"
#include "Preamble_ST_LG.h"
#define PREAMBLE_LEN 322  // 322 complex data

static float short_pre[322] = 
    {0.0230,0.0230, -0.132444,0.002340, -0.013473,-0.078525, 0.142755,-0.012651,
     0.091998,0.000000, 0.142755,-0.012651, -0.013473,-0.078525, -0.132444,0.002340,
     0.045999,0.045999, 0.002340,-0.132444, -0.078525,-0.013473, -0.012651,0.142755,
     0.000000,0.091998, -0.012651,0.142755, -0.078525,-0.013473, 0.002340,-0.132444,
     0.045999,0.045999, -0.132444,0.002340, -0.013473,-0.078525, 0.142755,-0.012651,
     0.091998,0.000000, 0.142755,-0.012651, -0.013473,-0.078525, -0.132444,0.002340,
     0.045999,0.045999, 0.002340,-0.132444, -0.078525,-0.013473, -0.012651,0.142755,
     0.000000,0.091998, -0.012651,0.142755, -0.078525,-0.013473, 0.002340,-0.132444,
     0.045999,0.045999, -0.132444,0.002340, -0.013473,-0.078525, 0.142755,-0.012651,
     0.091998,0.000000, 0.142755,-0.012651, -0.013473,-0.078525, -0.132444,0.002340,
     0.045999,0.045999, 0.002340,-0.132444, -0.078525,-0.013473, -0.012651,0.142755,
     0.000000,0.091998, -0.012651,0.142755, -0.078525,-0.013473, 0.002340,-0.132444, 
     0.045999,0.045999, -0.132444,0.002340, -0.013473,-0.078525, 0.142755,-0.012651, 
     0.091998,0.000000, 0.142755,-0.012651, -0.013473,-0.078525, -0.132444,0.002340, 
     0.045999,0.045999, 0.002340,-0.132444, -0.078525,-0.013473, -0.012651,0.142755,
     0.000000,0.091998, -0.012651,0.142755, -0.078525,-0.013473, 0.002340,-0.132444,
     0.046,0.046,       -0.132444,0.002340, -0.013473,-0.078525, 0.142755,-0.012651,
     0.091998,0.000000, 0.142755,-0.012651, -0.013473,-0.078525, -0.132444,0.002340,
     0.045999,0.045999, 0.002340,-0.132444, -0.078525,-0.013473, -0.012651,0.142755,
     0.000000,0.091998, -0.012651,0.142755, -0.078525,-0.013473, 0.002340,-0.132444,
     0.045999,0.045999, -0.132444,0.002340, -0.013473,-0.078525, 0.142755,-0.012651,
     0.091998,0.000000, 0.142755,-0.012651, -0.013473,-0.078525, -0.132444,0.002340,
     0.045999,0.045999, 0.002340,-0.132444, -0.078525,-0.013473, -0.012651,0.142755,
     0.000000,0.091998, -0.012651,0.142755, -0.078525,-0.013473, 0.002340,-0.132444,
     0.045999,0.045999, -0.132444,0.002340, -0.013473,-0.078525, 0.142755,-0.012651,
     0.091998,0.000000, 0.142755,-0.012651, -0.013473,-0.078525, -0.132444,0.002340,
     0.045999,0.045999, 0.002340,-0.132444, -0.078525,-0.013473, -0.012651,0.142755,
     0.000000,0.091998, -0.012651,0.142755, -0.078525,-0.013473, 0.002340,-0.132444, 
     0.045999,0.045999, -0.132444,0.002340, -0.013473,-0.078525, 0.142755,-0.012651, 
     0.091998,0.000000, 0.142755,-0.012651, -0.013473,-0.078525, -0.132444,0.002340, 
     0.045999,0.045999, 0.002340,-0.132444, -0.078525,-0.013473, -0.012651,0.142755,
     0.000000,0.091998, -0.012651,0.142755, -0.078525,-0.013473, 0.002340,-0.132444,
     0.045999,0.045999, -0.132444,0.002340, -0.013473,-0.078525, 0.142755,-0.012651,
     0.091998,0.000000, 0.142755,-0.012651, -0.013473,-0.078525, -0.132444,0.002340,
     0.045999,0.045999, 0.002340,-0.132444, -0.078525,-0.013473, -0.012651,0.142755,
     0.000000,0.091998, -0.012651,0.142755, -0.078525,-0.013473, 0.002340,-0.132444,
     0.045999,0.045999, -0.132444,0.002340, -0.013473,-0.078525, 0.142755,-0.012651,
     0.091998,0.000000, 0.142755,-0.012651, -0.013473,-0.078525, -0.132444,0.002340,
     0.045999,0.045999, 0.002340,-0.132444, -0.078525,-0.013473, -0.012651,0.142755,
     0.000000,0.091998, -0.012651,0.142755, -0.078525,-0.013473, 0.002340,-0.132444, 
     0.0230,0.0230};

static float long_pre[322] = {
      0.078,0.000,   0.012,-0.098,  0.092,-0.106, -0.092,-0.115,
     -0.003,-0.054,  0.075, 0.074, -0.127,0.021,  -0.122,0.017,
     -0.035,0.151,  -0.056,0.022,  -0.060,-0.081,  0.070,-0.014,
      0.082,-0.092, -0.131,-0.065, -0.057,-0.039,  0.037,-0.098,
      0.062,0.062,   0.119,0.004,  -0.022,-0.161,  0.059,0.015,
      0.024,0.059,  -0.137,0.047,   0.001,0.115,   0.053,-0.004,
      0.098,0.026,  -0.038,0.106,  -0.115,0.055,   0.060,0.088,
      0.021,-0.028,  0.097,-0.083,  0.040,0.111,  -0.005,0.120,
      0.156,0.000,  -0.005,-0.120,  0.040,-0.111,  0.097,0.083,
      0.021,0.028,   0.060,-0.088, -0.115,-0.055, -0.038,-0.106,
      0.098,-0.026,  0.053,0.004,   0.001,-0.115, -0.137,-0.047,
      0.024,-0.059,  0.059,-0.015, -0.022,0.161,   0.119,-0.004,
      0.062,-0.062,  0.037,0.098,  -0.057,0.039,  -0.131,0.065,
      0.082,0.092,   0.070,0.014,  -0.060,0.081,  -0.056,-0.022,
     -0.035,-0.151, -0.122,-0.017, -0.127,-0.021,  0.075,-0.074,
     -0.003,0.054,  -0.092,0.115,   0.092,0.106,   0.012,0.098,

     -0.156,0.000,   0.012,-0.098,  0.092,-0.106, -0.092,-0.115,
     -0.003,-0.054,  0.075,0.074,  -0.127,0.021,  -0.122,0.017,
     -0.035,0.151,  -0.056,0.022,  -0.060,-0.081,  0.070,-0.014,
      0.082,-0.092, -0.131,-0.065, -0.057,-0.039,  0.037,-0.098,
      0.062,0.062,   0.119,0.004,  -0.022,-0.161,  0.059,0.015,
      0.024,0.059,  -0.137,0.047,   0.001,0.115,   0.053,-0.004,
      0.098,0.026,  -0.038,0.106,  -0.115,0.055,   0.060,0.088,
      0.021,-0.028,  0.097,-0.083,  0.040,0.111,  -0.005,0.120,
      0.156,0.000,  -0.005,-0.120,  0.040,-0.111,  0.097,0.083,
      0.021,0.028,   0.060,-0.088, -0.115,-0.055, -0.038,-0.106,
      0.098,-0.026,  0.053,0.004,   0.001,-0.115, -0.137,-0.047,
      0.024,-0.059,  0.059,-0.015, -0.022,0.161,   0.119,-0.004,
      0.062,-0.062,  0.037,0.098,  -0.057,0.039,  -0.131,0.065,
      0.082,0.092,   0.070,0.014,  -0.060,0.081,  -0.056,-0.022,
     -0.035,-0.151, -0.122,-0.017, -0.127,-0.021,  0.075,-0.074,
     -0.003,0.054,  -0.092,0.115,   0.092,0.106,   0.012,0.098,

     -0.156,0.000,   0.012,-0.098,  0.092,-0.106, -0.092,-0.115,
     -0.003,-0.054,  0.075,0.074,  -0.127,0.021,  -0.122,0.017,
     -0.035,0.151,  -0.056,0.022,  -0.060,-0.081,  0.070,-0.014,
      0.082,-0.092, -0.131,-0.065, -0.057,-0.039,  0.037,-0.098,
      0.062,0.062,   0.119,0.004,  -0.022,-0.161,  0.059,0.015,
      0.024,0.059,  -0.137,0.047,   0.001,0.115,   0.053,-0.004,
      0.098,0.026,  -0.038,0.106,  -0.115,0.055,   0.060,0.088,
      0.021,-0.028,  0.097,-0.083,  0.040,0.111,  -0.005,0.120,
      0.078,0};

void preamble(comp_t iData[], comp_t oData[], int len) {

  int i;
  int preLen = PREAMBLE_LEN;

  float *iiData, *ooData;
  iiData = (float *)iData;
  ooData = (float *)oData;

  for(i=0; i<preLen; i++) {
    ooData[i] = short_pre[i];
    ooData[i+preLen] = long_pre[i];
  }
  for(i=0; i<len*2; i++) ooData[i+preLen*2] = iiData[i];

/*
  printf("after preamble insertion:\n");
  for(i=0; i<preLen+len; i++) {
    printf("%+4.4f,%+4.4f ", oData[i].real, oData[i].imag);
    if(i%4 == 3) printf("\n");
  }
  printf("\n");
*/
}
